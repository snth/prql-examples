
let from_csv = filename:'/dev/stdin' -> (
  from s"""SELECT * FROM read_csv_auto({filename})"""
)

let to_csv = filename:'/dev/stdout' rel -> (
  # Use SQL-injection to access the DuckDB COPY command
  s"""SELECT 'Writing to '{filename}' ...' AS status) SELECT * FROM table_0;COPY ({rel}) TO {filename} (FORMAT CSV); WITH table_0 AS (SELECT 'Completed '{filename}'.    ' as status"""
)
